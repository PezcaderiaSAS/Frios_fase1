<section class="animate-enter">
    <!-- Filter Card -->
    <section class="card border-start border-4 border-primary mb-4">
        <div class="card-body">
            <h5 class="fw-bold text-primary mb-3"><i class="fas fa-file-invoice-dollar me-2"></i>Generar Corte de
                Facturación</h5>
            <div class="row g-3 align-items-end">
                <div class="col-md-4">
                    <label class="form-label">Cliente</label>
                    <select id="bill-cliente" class="form-select">
                        <option value="" disabled selected>Seleccione...</option>
                        <!-- Injected -->
                    </select>
                </div>
                <div class="col-md-3">
                    <label class="form-label">Desde</label>
                    <input type="date" id="bill-inicio" class="form-control">
                </div>
                <div class="col-md-3">
                    <label class="form-label">Hasta</label>
                    <input type="date" id="bill-fin" class="form-control">
                </div>
                <div class="col-md-2">
                    <button id="bill-btn-calc" class="btn btn-primary w-100">
                        <i class="fas fa-calculator me-1"></i> Calcular
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Loader -->
    <div id="bill-loading" class="text-center py-5 d-none">
        <div class="spinner-border text-primary" role="status"></div>
        <p class="text-muted mt-2">Calculando corte...</p>
    </div>

    <!-- Results Section -->
    <article id="bill-results" class="d-none">
        <!-- KPI Cards -->
        <div class="row g-3 mb-4">
            <div class="col-6 col-md-3">
                <div class="card p-3 text-center h-100 bg-light">
                    <small class="text-muted fw-bold text-uppercase">Días Totales</small>
                    <div id="bill-kpi-dias" class="display-6 fw-bold text-dark">0</div>
                </div>
            </div>
            <div class="col-6 col-md-3">
                <div class="card p-3 text-center h-100 bg-white border-info">
                    <small class="text-muted fw-bold text-uppercase">Base Contrato</small>
                    <div id="bill-kpi-base" class="fs-3 fw-bold text-info">$0</div>
                </div>
            </div>
            <div class="col-6 col-md-3">
                <div class="card p-3 text-center h-100 bg-warning-subtle border-0">
                    <small class="text-warning-emphasis fw-bold text-uppercase">Excedentes</small>
                    <div id="bill-kpi-exce" class="fs-3 fw-bold text-warning-emphasis">$0</div>
                    <small id="bill-kpi-exce-dias" class="text-muted">0 días con exceso</small>
                </div>
            </div>
            <div class="col-6 col-md-3">
                <div class="card p-3 text-center h-100 bg-dark text-white">
                    <small class="opacity-50 fw-bold text-uppercase">Total a Pagar</small>
                    <div id="bill-kpi-total" class="fs-2 fw-bold">$0</div>
                </div>
            </div>
        </div>

        <!-- Indicador Tipo Pago -->
        <div class="row mb-4">
            <div class="col-12">
                <div id="bill-alert-type" class="alert mb-0 alert-success">
                    <i id="bill-icon-type" class="fas fa-calendar-check me-2"></i>
                    <strong>Tipo de Facturación:</strong> <span id="bill-type-text">Prepago</span>
                    <div id="bill-type-desc" class="small mt-1">Costo base incluye posiciones contratadas.</div>
                </div>
            </div>
        </div>

        <!-- PDF Actions -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="alert alert-light border d-flex justify-content-between align-items-center">
                    <div><i class="fas fa-file-pdf me-2 text-danger"></i><strong>Opciones de Exportación</strong></div>
                    <div class="d-flex gap-2">
                        <button id="bill-btn-pdf-brief" class="btn btn-success btn-sm"><i
                                class="fas fa-file-invoice me-1"></i> Resumen Ejecutivo</button>
                        <button id="bill-btn-pdf-detail" class="btn btn-primary btn-sm"><i
                                class="fas fa-list-alt me-1"></i> Informe Detallado</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Detail Table -->
        <section class="card">
            <header class="card-header bg-white">Desglose Diario de Ocupación</header>
            <div class="table-responsive" style="max-height: 500px;">
                <table class="table table-sm table-striped mb-0 small">
                    <thead class="table-light sticky-top">
                        <tr>
                            <th class="ps-4">Fecha</th>
                            <th class="text-end">Stock (Kg)</th>
                            <th class="text-end">Pos. Usadas</th>
                            <th class="text-end">Contratado</th>
                            <th class="text-end">Excedente</th>
                            <th class="text-end pe-4">Costo Día</th>
                        </tr>
                    </thead>
                    <tbody id="bill-table-body">
                        <!-- Injected -->
                    </tbody>
                </table>
            </div>
        </section>
    </article>
</section>